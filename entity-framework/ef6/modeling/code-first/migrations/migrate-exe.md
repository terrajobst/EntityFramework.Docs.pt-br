---
title: Usando Migrate. exe-EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
ms.openlocfilehash: 34866ddbbf81f090a064af148a612dd354ae9401
ms.sourcegitcommit: 7a709ce4f77134782393aa802df5ab2718714479
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/04/2019
ms.locfileid: "74824817"
---
# <a name="using-migrateexe"></a><span data-ttu-id="6ac3f-102">Usando o Migrate. exe</span><span class="sxs-lookup"><span data-stu-id="6ac3f-102">Using migrate.exe</span></span>
<span data-ttu-id="6ac3f-103">Migrações do Code First pode ser usado para atualizar um banco de dados de dentro do Visual Studio, mas também pode ser executado por meio da ferramenta de linha de comando Migrate. exe.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-103">Code First Migrations can be used to update a database from inside visual studio, but can also be executed via the command line tool migrate.exe.</span></span> <span data-ttu-id="6ac3f-104">Esta página fornecerá uma visão geral rápida sobre como usar o Migrate. exe para executar migrações em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-104">This page will give a quick overview on how to use migrate.exe to execute migrations against a database.</span></span>

> [!NOTE]
> <span data-ttu-id="6ac3f-105">Este artigo pressupõe que você saiba como usar Migrações do Code First em cenários básicos.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-105">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="6ac3f-106">Caso contrário, você precisará ler [migrações do Code First](~/ef6/modeling/code-first/migrations/index.md) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-106">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="copy-migrateexe"></a><span data-ttu-id="6ac3f-107">Copiar Migrate. exe</span><span class="sxs-lookup"><span data-stu-id="6ac3f-107">Copy migrate.exe</span></span>

<span data-ttu-id="6ac3f-108">Quando você instala Entity Framework usando o NuGet, o. exe estará dentro da pasta Ferramentas do pacote baixado.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-108">When you install Entity Framework using NuGet migrate.exe will be inside the tools folder of the downloaded package.</span></span> <span data-ttu-id="6ac3f-109">Na pasta &lt;projeto&gt;\\pacotes\\EntityFramework.&lt;versão&gt;ferramentas de \\</span><span class="sxs-lookup"><span data-stu-id="6ac3f-109">In &lt;project folder&gt;\\packages\\EntityFramework.&lt;version&gt;\\tools</span></span>

<span data-ttu-id="6ac3f-110">Depois de migrar. exe, você precisará copiá-lo para o local do assembly que contém as migrações.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-110">Once you have migrate.exe then you need to copy it to the location of the assembly that contains your migrations.</span></span>

<span data-ttu-id="6ac3f-111">Se o seu aplicativo tiver como alvo o .NET 4, e não 4,5, você precisará copiar o **redirect. config** no local também e renomeá-lo como **migrar. exe. config**. Isso é para que o Migrate. exe obtenha os redirecionamentos de ligação corretos para poder localizar o assembly Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-111">If your application targets .NET 4, and not 4.5, then you will need to copy the **Redirect.config** into the location as well and rename it **migrate.exe.config**. This is so that migrate.exe gets the correct binding redirects to be able to locate the Entity Framework assembly.</span></span>

| <span data-ttu-id="6ac3f-112">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="6ac3f-112">.NET 4.5</span></span>                                      | <span data-ttu-id="6ac3f-113">.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="6ac3f-113">.NET 4.0</span></span>                                      |
|:----------------------------------------------|:----------------------------------------------|
| ![Arquivos do .NET 4,5](~/ef6/media/net45files.png) | ![Arquivos do .NET 4,0](~/ef6/media/net40files.png) |

> [!NOTE]
> <span data-ttu-id="6ac3f-116">o Migrate. exe não dá suporte a assemblies x64.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-116">migrate.exe doesn't support x64 assemblies.</span></span>

<span data-ttu-id="6ac3f-117">Depois de mover o Migrate. exe para a pasta correta, você poderá usá-lo para executar migrações no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-117">Once you have moved migrate.exe to the correct folder then you should be able to use it to execute migrations against the database.</span></span> <span data-ttu-id="6ac3f-118">Tudo o que o utilitário foi projetado para fazer é executar migrações.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-118">All the utility is designed to do is execute migrations.</span></span> <span data-ttu-id="6ac3f-119">Ele não pode gerar migrações ou criar um script SQL.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-119">It cannot generate migrations or create a SQL script.</span></span>

## <a name="see-options"></a><span data-ttu-id="6ac3f-120">Consulte Opções</span><span class="sxs-lookup"><span data-stu-id="6ac3f-120">See options</span></span>

``` console
Migrate.exe /?
```

<span data-ttu-id="6ac3f-121">O acima exibirá a página de ajuda associada a esse utilitário, observe que será necessário ter o EntityFramework. dll no mesmo local em que você está executando o Migrate. exe para que isso funcione.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-121">The above will display the help page associated with this utility, note that you will need to have the EntityFramework.dll in the same location that you are running migrate.exe in order for this to work.</span></span>

## <a name="migrate-to-the-latest-migration"></a><span data-ttu-id="6ac3f-122">Migrar para a migração mais recente</span><span class="sxs-lookup"><span data-stu-id="6ac3f-122">Migrate to the latest migration</span></span>

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="6ac3f-123">Ao executar migre. exe, o único parâmetro obrigatório é o assembly, que é o assembly que contém as migrações que você está tentando executar, mas ele usará todas as configurações baseadas em convenção se você não especificar o arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-123">When running migrate.exe the only mandatory parameter is the assembly, which is the assembly that contains the migrations that you are trying to run, but it will use all convention based settings if you do not specify the configuration file.</span></span>

## <a name="migrate-to-a-specific-migration"></a><span data-ttu-id="6ac3f-124">Migrar para uma migração específica</span><span class="sxs-lookup"><span data-stu-id="6ac3f-124">Migrate to a specific migration</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /targetMigration="AddTitle"
```

<span data-ttu-id="6ac3f-125">Se você quiser executar migrações para uma migração específica, poderá especificar o nome da migração.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-125">If you want to run migrations up to a specific migration, then you can specify the name of the migration.</span></span> <span data-ttu-id="6ac3f-126">Isso executará todas as migrações anteriores, conforme necessário, até chegar à migração especificada.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-126">This will run all previous migrations as required until getting to the migration specified.</span></span>

## <a name="specify-working-directory"></a><span data-ttu-id="6ac3f-127">Especificar diretório de trabalho</span><span class="sxs-lookup"><span data-stu-id="6ac3f-127">Specify working directory</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /startupDirectory="c:\\MyApp"
```

<span data-ttu-id="6ac3f-128">Se o assembly tiver dependências ou ler arquivos relativos ao diretório de trabalho, será necessário definir startupDirectory.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-128">If you assembly has dependencies or reads files relative to the working directory then you will need to set startupDirectory.</span></span>

## <a name="specify-migration-configuration-to-use"></a><span data-ttu-id="6ac3f-129">Especificar a configuração de migração a ser usada</span><span class="sxs-lookup"><span data-stu-id="6ac3f-129">Specify migration configuration to use</span></span>

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="6ac3f-130">Se você tiver várias classes de configuração de migração, classes herdadas de DbMigrationConfiguration, será necessário especificar qual será usada para essa execução.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-130">If you have multiple migration configuration classes, classes inheriting from DbMigrationConfiguration, then you need to specify which is to be used for this execution.</span></span> <span data-ttu-id="6ac3f-131">Isso é especificado fornecendo o segundo parâmetro opcional sem uma opção como acima.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-131">This is specified by providing the optional second parameter without a switch as above.</span></span>

## <a name="provide-connection-string"></a><span data-ttu-id="6ac3f-132">Fornecer cadeia de conexão</span><span class="sxs-lookup"><span data-stu-id="6ac3f-132">Provide connection string</span></span>

``` console
Migrate.exe BlogDemo.dll /connectionString="Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI" /connectionProviderName="System.Data.SqlClient"
```

<span data-ttu-id="6ac3f-133">Se você quiser especificar uma cadeia de conexão na linha de comando, também deverá fornecer o nome do provedor.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-133">If you wish to specify a connection string at the command line then you must also provide the provider name.</span></span> <span data-ttu-id="6ac3f-134">Não especificar o nome do provedor causará uma exceção.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-134">Not specifying the provider name will cause an exception.</span></span>

## <a name="common-problems"></a><span data-ttu-id="6ac3f-135">Problemas comuns</span><span class="sxs-lookup"><span data-stu-id="6ac3f-135">Common Problems</span></span>

| <span data-ttu-id="6ac3f-136">Mensagem de Erro</span><span class="sxs-lookup"><span data-stu-id="6ac3f-136">Error Message</span></span>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="6ac3f-137">{1&gt;&lt;1} Solução</span><span class="sxs-lookup"><span data-stu-id="6ac3f-137">Solution</span></span>                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6ac3f-138">Exceção sem tratamento: System. IO. FileLoadException: não foi possível carregar o arquivo ou assembly ' EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 ' ou uma de suas dependências.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-138">Unhandled Exception: System.IO.FileLoadException:  Could not load file or assembly 'EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="6ac3f-139">A definição do manifesto do assembly localizado não corresponde à referência do assembly.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-139">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="6ac3f-140">(Exceção de HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="6ac3f-140">(Exception from HRESULT: 0x80131040)</span></span>         | <span data-ttu-id="6ac3f-141">Isso normalmente significa que você está executando um aplicativo .NET 4 sem o arquivo reredirect. config.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-141">This typically means that you are running a .NET 4 application without the Redirect.config file.</span></span> <span data-ttu-id="6ac3f-142">Você precisa copiar o redirect. config para o mesmo local que o Migrate. exe e renomeá-lo como Migrate. exe. config.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-142">You need to copy the Redirect.config to the same location as migrate.exe and rename it to migrate.exe.config.</span></span>                                                                                       |
| <span data-ttu-id="6ac3f-143">Exceção sem tratamento: System. IO. FileLoadException: não foi possível carregar o arquivo ou assembly ' EntityFramework, Version = 4.4.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 ' ou uma de suas dependências.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-143">Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="6ac3f-144">A definição do manifesto do assembly localizado não corresponde à referência do assembly.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-144">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="6ac3f-145">(Exceção de HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="6ac3f-145">(Exception from HRESULT: 0x80131040)</span></span>          | <span data-ttu-id="6ac3f-146">Essa exceção significa que você está executando um aplicativo .NET 4,5 com o redirect. config copiado para o local Migrate. exe.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-146">This exception means that you are running a .NET 4.5 application with the Redirect.config copied to the migrate.exe location.</span></span> <span data-ttu-id="6ac3f-147">Se seu aplicativo for .NET 4,5, você não precisará ter o arquivo de configuração com os redirecionamentos dentro do.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-147">If your app is .NET 4.5 then you do not need to have the config file with the redirects inside.</span></span> <span data-ttu-id="6ac3f-148">Exclua o arquivo Migrate. exe. config.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-148">Delete the migrate.exe.config file.</span></span>                                    |
| <span data-ttu-id="6ac3f-149">ERRO: não é possível atualizar o banco de dados para corresponder ao modelo atual porque há alterações pendentes e a migração automática está desabilitada.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-149">ERROR: Unable to update database to match the current model because there are pending changes and automatic migration is disabled.</span></span> <span data-ttu-id="6ac3f-150">Grave as alterações de modelo pendentes em uma migração baseada em código ou habilite a migração automática.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-150">Either write the pending model changes to a code-based migration or enable automatic migration.</span></span> <span data-ttu-id="6ac3f-151">Defina DbMigrationsConfiguration. AutomaticMigrationsEnabled como true para habilitar a migração automática.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-151">Set DbMigrationsConfiguration.AutomaticMigrationsEnabled to true to enable automatic migration.</span></span> | <span data-ttu-id="6ac3f-152">Esse erro ocorrerá se você estiver executando migrar quando não tiver criado uma migração para lidar com as alterações feitas no modelo e o banco de dados não corresponder ao modelo.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-152">This error occurs if running migrate when you haven’t created a migration to cope with changes made to the model, and the database does not match the model.</span></span> <span data-ttu-id="6ac3f-153">A adição de uma propriedade a uma classe de modelo, em seguida, a execução de migrar. exe sem a criação de uma migração para atualizar o banco de dados é um exemplo disso.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-153">Adding a property to a model class then running migrate.exe without creating a migration to upgrade the database is an example of this.</span></span> |
| <span data-ttu-id="6ac3f-154">ERRO: o tipo não foi resolvido para o membro ' System. Data. Entity. Migrations. Design. ToolingFacade + UpdateRunner, EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 '.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-154">ERROR: Type is not resolved for member 'System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</span></span>                                                                                                                                       | <span data-ttu-id="6ac3f-155">Esse erro pode ser causado pela especificação de um diretório de inicialização incorreto.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-155">This error can be caused by specifying an incorrect startup directory.</span></span> <span data-ttu-id="6ac3f-156">Deve ser o local de Migrate. exe</span><span class="sxs-lookup"><span data-stu-id="6ac3f-156">This must be the location of migrate.exe</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="6ac3f-157">Exceção sem tratamento: System. NullReferenceException: referência de objeto não definida como uma instância de um objeto.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-157">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.</span></span> <br/>   <span data-ttu-id="6ac3f-158">em System. Data. Entity. Migrations. console. Program. Main (String [] args)</span><span class="sxs-lookup"><span data-stu-id="6ac3f-158">at System.Data.Entity.Migrations.Console.Program.Main(String[] args)</span></span>                                                                                                                                             | <span data-ttu-id="6ac3f-159">Isso pode ser causado por não especificar um parâmetro obrigatório para um cenário que você está usando.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-159">This can be caused by not specifying a required parameter for a scenario that you are using.</span></span> <span data-ttu-id="6ac3f-160">Por exemplo, especificando uma cadeia de conexão sem especificar o nome do provedor.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-160">For example specifying a connection string without specifying the provider name.</span></span>                                                                                                                        |
| <span data-ttu-id="6ac3f-161">ERRO: mais de um tipo de configuração de migrações foi encontrado no assembly ' ClassLibrary1 '.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-161">ERROR: More than one migrations configuration type was found in the assembly 'ClassLibrary1'.</span></span> <span data-ttu-id="6ac3f-162">Especifique o nome do um a ser usado.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-162">Specify the name of the one to use.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="6ac3f-163">Como o erro diz, há mais de uma classe de configuração no assembly fornecido.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-163">As the error states, there is more than one configuration class in the given assembly.</span></span> <span data-ttu-id="6ac3f-164">Você deve usar a opção/configurationType para especificar qual usar.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-164">You must use the /configurationType switch to specify which to use.</span></span>                                                                                                                                           |
| <span data-ttu-id="6ac3f-165">ERRO: não foi possível carregar o arquivo ou o assembly '&lt;assemblyName&gt;' ou uma de suas dependências.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-165">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;’ or one of its dependencies.</span></span> <span data-ttu-id="6ac3f-166">O nome ou a codebase do assembly fornecido era inválido.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-166">The given assembly name or codebase was invalid.</span></span> <span data-ttu-id="6ac3f-167">(Exceção de HRESULT: 0x80131047)</span><span class="sxs-lookup"><span data-stu-id="6ac3f-167">(Exception from HRESULT: 0x80131047)</span></span>                                                                                                                                                    | <span data-ttu-id="6ac3f-168">Isso pode ser causado pela especificação de um nome de assembly incorretamente ou por não ter</span><span class="sxs-lookup"><span data-stu-id="6ac3f-168">This can be caused by specifying an assembly name incorrectly or not having</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="6ac3f-169">ERRO: não foi possível carregar o arquivo ou o assembly '&lt;assemblyName&gt;' ou uma de suas dependências.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-169">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;' or one of its dependencies.</span></span> <span data-ttu-id="6ac3f-170">Foi feita uma tentativa para carregar um programa com um formato incorreto.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-170">An attempt was made to load a program with an incorrect format.</span></span>                                                                                                                                                                          | <span data-ttu-id="6ac3f-171">Isso acontece se você estiver tentando executar o Migrate. exe em um aplicativo x64.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-171">This happens if you are trying to run migrate.exe against an x64 application.</span></span> <span data-ttu-id="6ac3f-172">O EF 5,0 e inferior funcionarão apenas no x86.</span><span class="sxs-lookup"><span data-stu-id="6ac3f-172">EF 5.0 and below will only work on x86.</span></span>                                                                                                                                                                                |
